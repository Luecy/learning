<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<style>
			@charset "UTF-8";body,html{height:100%}#p_fixed,#p_space{padding-top:4rem;padding-left:100%}#p_fixed,#p_space,#p_state{top:0;left:0;margin:0}#canvas,#img,textarea{width:100%}*{display:block;box-sizing:border-box;position:relative;font:100% sans-serif}.div_UI,head,script{display:none}#button_download,#input_jpg,#radio_jpg,#radio_png,.input_radio{display:inline}body{margin:0;padding:8px}textarea{border:1px solid gray;padding:2px;resize:none;border-radius:2px;white-space:pre}textarea:focus{outline:0;border:2px solid orange}button{border:1px solid gray;border-radius:2px;padding:2px 7px;background-color:#f0f0f0}button:active{border-color:#909090;background-color:#f8f8f8}#canvas{padding-bottom:1rem}#div_UI,#div_download{border:1px solid #000;padding:1rem}#input_jpg{visibility:hidden}#p_fixed{z-index:1;position:fixed;background-color:#fdd}#p_state{z-index:2;position:fixed;padding:1rem}#UI_resize{display:block}
		</style>
		<title>Image Editor</title>
	</head>
	<body>
		<p id="p_space"></p>
		<p id="p_fixed"></p>
		<p id="p_state">ページを読み込んでいます</p>
		<input type="file" id="input_file">
		<button type="button" id="button_reset">reset</button>
		<div id="div_download">
			<input type="text" id="input_filename" value="00.png" placeholder="file name">
			<input type="radio" name="image_type" id="radio_png" checked>png<br>
			<input type="radio" name="image_type" id="radio_jpg">jpg
			<input type="number" id="input_jpg" value="0.85" placeholder="JPEGの圧縮率"><br>
			<button id="button_download" type="button">ダウンロード</button>
			<a id="anchor">download</a>
		</div>
		<div>
			<input type="radio" name="radio" id="radio_resize" class="input_radio" checked>resize<br>
			<input type="radio" name="radio" id="radio_enlarge" class="input_radio">enlarge<br>
			<input type="radio" name="radio" id="radio_reverse" class="input_radio">reverse<br>
			<input type="radio" name="radio" id="radio_space" class="input_radio">space<br>
			<input type="radio" name="radio" id="radio_cut" class="input_radio">cut<br>
			<input type="radio" name="radio" id="radio_insert" class="input_radio">insert<br>
			<input type="radio" name="radio" id="radio_rotate" class="input_radio">rotate<br>
		</div>
		<div id="div_UI">
			<div id="UI_resize" class="div_UI">
				<input type="number" id="input_resize_width" placeholder="width">
				<input type="number" id="input_resize_height" placeholder="height">
				<input type="number" id="input_resize_ratio" placeholder="倍率">
				<button id="button_resize" type="button">resize</button>
			</div>
			<div id="UI_enlarge" class="div_UI">
				<input type="number" id="input_enlarge" placeholder="自然数">
				<button id="button_enlarge" type="button">enlarge</button>
			</div>
			<div id="UI_reverse" class="div_UI">
				<button id="button_reverse" type="button">左右反転</button>
			</div>
			<div id="UI_space" class="div_UI">
				<input type="number" id="input_space_left" placeholder="left">
				<input type="number" id="input_space_right" placeholder="right">
				<input type="number" id="input_space_top" placeholder="top">
				<input type="number" id="input_space_bottom" placeholder="bottom">
				<input type="text" id="input_space_background" value="#000000ff" placeholder="background-color">
				<button id="button_space" type="button">実行</button>
			</div>
			<div id="UI_cut" class="div_UI">
				<input type="number" id="input_cut_left" placeholder="left">
				<input type="number" id="input_cut_right" placeholder="right">
				<input type="number" id="input_cut_top" placeholder="top">
				<input type="number" id="input_cut_bottom" placeholder="bottom">
				<button id="button_cut" type="button">cut</button>
			</div>
			<div id="UI_insert" class="div_UI">
				<input type="file" id="input_file_insert">
				<input type="number" id="input_insert_left" placeholder="left">
				<input type="number" id="input_insert_top" placeholder="top">
				<button id="button_insert" type="button">insert</button>
			</div>
			<div id="UI_rotate" class="div_UI">
				<button id="button_rotate" type="button">rotate</button>
			</div>
		</div>
		<input type="text" id="input_canvasSize" value="100%" placeholder="canvas.style.width">
		<button type="button" id="button_undo">undo/redo</button>
		<div id="div_canvasSize"></div>
		<canvas id="canvas" width=1 height=1></canvas>
		<button type="button" id="button_canvasToImg">img要素に描画</button>
		<button type="button" id="button_imgToCanvas">img要素から描画</button>
		<img id="img">
		<div>
			<script>
				(()=>{"use strict";let t="editImage.js",e=Object.prototype.toString,a=async(t,a=document.querySelector("canvas"),i,l,n=0,r=0,c=!0)=>{if("[object File]"!==e.call(t)&&"[object Blob]"!==e.call(t))return null;let h=new FileReader,g=new Image;return h.readAsDataURL(t),g.src=await new Promise(t=>{h.onload=()=>{t(h.result)}}),await g.decode().then(()=>{let t=a.getContext("2d");void 0==i&&(i=g.naturalWidth),void 0==l&&(l=g.naturalHeight),void 0==n&&(n=0),void 0==r&&(r=0),c&&(a.width=i,a.height=l),t.drawImage(g,n,r,i,l)}).catch(t=>t)},i=async(t,a)=>{let i=(()=>"[object HTMLCanvasElement]"===e.call(a)?a:document.createElement("canvas"))``,l=i.getContext("2d");return"[object ImageData]"===e.call(t)?(i.width=t.width,i.height=t.height,l.putImageData(t,0,0),i):"[object HTMLImageElement]"===e.call(t)||"[object ImageBitmap]"===e.call(t)||"[object HTMLCanvasElement]"===e.call(t)?("[object HTMLImageElement]"===e.call(t)?(i.width=t.naturalWidth,i.height=t.naturalHeight):(i.width=t.width,i.height=t.height),l.drawImage(t,0,0),i):"[object File]"===e.call(t)||"[object Blob]"===e.call(t)?new Promise(e=>{let a=new FileReader;a.readAsDataURL(t),a.onload=()=>{let t=new Image;t.src=a.result,t.onload=()=>{i.width=t.naturalWidth,i.height=t.naturalHeight,l.drawImage(t,0,0),e(i)}}}):void 0},l=async t=>{if("[object ImageData]"===e.call(t))return t;if("[object HTMLCanvasElement]"===e.call(t)){let a=t.getContext("2d");return a.getImageData(0,0,t.width,t.height)}{let l=await i(t),n=l.getContext("2d");return n.getImageData(0,0,l.width,l.height)}},n=async(t,a="image/png",l=.85,n=!1)=>{if(("[object Blob]"===e.call(t)||"[object File]"===e.call(t))&&!1==n)return t;let r=await i(t);return new Promise(t=>{r.toBlob(e=>{t(e)},a,l)})},r=async t=>{if("[object HTMLImageElement]"===e.call(t))return t;{let a=await n(t),i=await new Promise(t=>{let e=new FileReader;e.readAsDataURL(a),e.onload=()=>{t(e.result)}}),l=new Image;return l.src=i,l.decode().then(()=>l).catch(t=>t)}},c=async t=>{if("[object ImageBitmap]"===e.call(t))return t;if("[object HTMLImageElement]"===e.call(t))return createImageBitmap(t,0,0,t.naturalWidth,t.naturalHeight);if("[object File]"!==e.call(t)&&"[object Blob]"!==e.call(t))return createImageBitmap(t,0,0,t.width,t.height);{let a=await r(t);return createImageBitmap(a,0,0,a.naturalWidth,a.naturalHeight)}},h=async(t,e)=>{if("canvas"===e)return await i(t);if("imageElement"===e)return await r(t);if("imageData"===e)return await l(t);if("imageBitmap"===e)return await c(t);if("blob"===e)return await n(t)},g=(()=>{let t=(t=0)=>new Promise(e=>{setTimeout(e,t)});return async(e,a,i)=>{await t();let l=Math.trunc(i/100),n=i%100,r=0;for(let c=0;c<100;c++){for(let h=0;h<l;h++)e();r<n&&(e(),r++),a(),await t()}}})``,w=async(t,e,i,l="imageData")=>{if(!Number.isInteger(e)||e<1||!Number.isInteger(i)||i<1)return null;let r=await n(t),c=document.createElement("canvas");return await a(r,c,e,i),await h(c,l)},o=async(t,e,a,i="imageData",n)=>{let r=await l(t);if(!Number.isInteger(e)||e<2)return null;void 0==a&&(a=document.createElement("canvas")),void 0==n&&(n=()=>{}),a.width=r.width*e,a.height=r.height*e;{let c=a.getContext("2d"),w=r.data.length/4,o=0,d=0,$=0,u=1;return await g(()=>{let t=r.data[$++],i=r.data[$++],l=r.data[$++],n=r.data[$++];c.fillStyle=`rgba(${t}, ${i}, ${l}, ${n})`,c.fillRect(o,d,e,e),o<a.width-e?o+=e:(o=0,d+=e)},()=>{n(u),u++},w),await h(a,i)}},d=async(t,e="imageData")=>{let a=document.createElement("canvas"),i=a.getContext("2d"),l=await r(t),n=l.naturalWidth,c=l.naturalHeight;return a.width=c,a.height=n,i.rotate(90*Math.PI/180),i.translate(0,-c),i.drawImage(l,0,0,n,c),await h(a,e)},$=async(t,e="imageData")=>{let a=await l(t),i=a.width,n=a.height,r=new ImageData(i,n),c=0,g=4*i-4;for(let w=0;w<n;w++){for(let o=0;o<i;o++){for(let d=0;d<4;d++)r.data[g]=a.data[c],c++,g++;g-=8}g+=8*i}return await h(r,e)},u=(()=>{let t=t=>((!Number.isInteger(t=Number(t))||t<0)&&(t=0),t);return async(e,a,i,n,r,c="#000000ff",g="imageData")=>{a=t(a),i=t(i),n=t(n),r=t(r);{let w=await l(e),o=document.createElement("canvas"),d=o.getContext("2d");return o.width=w.width+a+i,o.height=w.height+n+r,d.fillStyle=c,d.fillRect(0,0,o.width,o.height),d.putImageData(w,a,n),await h(o,g)}}})``,m=async(t,e,a,i,n,r="imageData")=>{let c=document.createElement("canvas"),g=c.getContext("2d"),w=await l(t);return c.width=w.width-(e+a),c.height=w.height-(i+n),g.putImageData(w,-e,-i),await h(c,r)},s=async(t,e,a,n,c,g="imageData")=>{let w=(()=>void 0==c?document.createElement("canvas"):c)``,o=w.getContext("2d");return t=await l(t),e=await r(e),await i(t,w),o.drawImage(e,a,n),h(w,g)};if(!0===self.hasOwnProperty(t))throw Error(`window["${t}"] is in conflict`);for(let f in self[t]=Object.preventExtensions({drawImagefileToCanvas:a,imageToCanvas:i,toImageData:l,imageToBlob:n,toImageElement:r,toImageBitmap:c,changeType:h,asyncLoop:g,resize:w,enlarge:o,rotate:d,reverse:$,space:u,cut:m,insert:s}),self[t])Object.defineProperty(self[t],f,{writable:!1});Object.defineProperty(self,t,{writable:!1})})``;
				(()=>{"use strict";let e=new Map([["self",["defineProperty","freezeProperty","$","sleep","downloadFile","download","canvasToURL","drawImagefileToCanvas"]],["Math",["randomInt"]],["Blob.prototype",["uint8Array","dataURL"]],["String.prototype",["atob","btoa","toUTF8","toUTF16","base16Decode","normalizeNewline","trimIndent"]],["Uint8Array.prototype",["btoa","text","loop","random","base16Encode"]]]),t=(e,t,r="self",n=!1,l=!0,o=!0)=>{let a=e=>{let t=e.split("."),r=self;for(let n of t)r=r[n];return r},i=(e="self",t=[""])=>{"string"==typeof t&&(t=[t]);let r=a(e);for(let n of t)try{if(!0===r.hasOwnProperty(n))throw Error(`[${e}.${n}] is in conflict`)}catch(l){console.error(l)}};!1===Array.isArray(e)&&(e=[e]),!1===Array.isArray(t)&&(t=[t]),i(r,e),r=a(r);for(let f=0;f<t.length;f++)Object.defineProperty(r,e[f],{value:t[f],configurable:l,writable:n,enumerable:o})},r=[t,(e,t=self)=>{"string"==typeof e&&(e=[e]);for(let r=0;r<e.length;r++)Object.defineProperty(t,e[r],{configurable:!1,enumerable:!0,writable:!1})},e=>{let t=document.querySelectorAll(e);return 1===t.length?t[0]:t},(e=0)=>new Promise(t=>{setTimeout(t,e)}),(e,t="00",r=document.querySelector("a"))=>{"[object Uint8Array]"===toString.call(e)&&(e=new Blob([e]));{let n=URL.createObjectURL(e);return""==t&&(t="00.txt"),r.download=t,r.href=n,n}},(e,t="00")=>{let r=document.createElement("a");"[object Uint8Array]"===toString.call(e)&&(e=new Blob([e]));{let n=URL.createObjectURL(e);r.href=n,r.download=t,r.click(),URL.revokeObjectURL(n)}},(e=document.querySelector("canvas"),t="image/png",r=.85)=>new Promise(n=>{e.toBlob(e=>{let t=URL.createObjectURL(e);n(t)},t,r)}),async(e,t=document.querySelector("canvas"),r,n,l=0,o=0,a=!0)=>{if("[object File]"!==toString.call(e)&&"[object Blob]"!==toString.call(e))return null;let i=new FileReader,f=new Image;return i.readAsDataURL(e),f.src=await new Promise(e=>{i.onload=()=>{e(i.result)}}),await f.decode().then(()=>{let e=t.getContext("2d");void 0==r&&(r=f.naturalWidth),void 0==n&&(n=f.naturalHeight),void 0==l&&(l=0),void 0==o&&(o=0),a&&(t.width=r,t.height=n),e.drawImage(f,l,o,r,n)}).catch(e=>e)},(e=255,t=0)=>Math.floor(Math.random()*(e-t+1)+t),async function(){let e=await this.arrayBuffer();return new Uint8Array(e)},function(){return new Promise(e=>{let t=new FileReader;t.readAsDataURL(this),t.onload=()=>{e(t.result)}})},function(){let e=atob(this.replace(/.*,/,"")),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},async function(){let e=new Blob([this]),t=await e.arrayBuffer(),r=new Uint8Array(t),n="";for(let l of r)n+=String.fromCharCode(l);return btoa(n)},function(){return new TextEncoder().encode(this)},function(e,t=!1){let r=(()=>{let e=Array(this.length);for(let t=0;t<this.length;t++){let r=this.charCodeAt(t);e[t]=r.toString(16).padStart(4,"0")}return e.join("").split("")})``,n=new Uint8Array(2*this.length);for(let l=0,o=0;l<r.length;l++){let a=r[o]+r[o+1];o+=2,n[l]=parseInt(a,16)}if(e=(()=>"be"===e||"BE"===e?"BE":"le"===e||"LE"===e?"LE":void 0)``,t=(()=>{let r=[254,255];return void 0===e||"BE"===e&&!0==t?r:"LE"===e&&!0==t&&[255,254]})``,"LE"===e)for(let i=0;i<n.length;i+=2){let f=n[i],c=n[i+1];n[i]=c,n[i+1]=f}if(!1!==t){let h=new Uint8Array(n.length+2),$=0;for(let u of(h[$++]=t[0],h[$++]=t[1],n))h[$++]=u;return h}return n},function(){let e=this.replace(/[^0-9A-Fa-f]/g,"").split(""),t=new Uint8Array(e.length/2);for(let r=0,n=0;r<t.length;r++){let l=e[n]+e[n+1];t[r]=parseInt(l,16),n+=2}return t},function(e="\n"){return this.replace(/\r\n|\r|\n/g,e)},function(e=!0,t=!0){let r=this.replace(/^ +|^\t+/mg,"");return!0==e&&(r=r.trimStart()),!0==t&&(r=r.trimEnd()),r},function(){let e="";for(let t of this)e+=String.fromCharCode(t);return btoa(e)},function(e="UTF-8"){return"UTF-16"===e&&(e="UTF-16BE"),new Promise(t=>{let r=new Blob([this]),n=new FileReader;n.readAsText(r,e),n.onload=()=>{t(n.result)}})},function(e=0,t=255,r=0,n=this.length-1){let l=e;for(let o=r;o<=n;o++)this[o]=l,++l>t&&(l=e);return this},function(e=0,t=255,r=0,n=this.length-1){for(let l=r;l<=n;l++)this[l]=Math.floor(Math.random()*(t-e+1)+e);return this},function(e="",t=!0,r=!0){let n=Array(this.length);for(let l=0;l<n.length;l++)n[l]=this[l].toString(16),!0===r&&(n[l]=n[l].toUpperCase()),!0===t&&(n[l]=n[l].padStart(2,"0"));return n.join(e)}],n=0;for(let l of e){let o=l[0],a=l[1],i=(()=>{let e=Array(a.length);for(let t=0;t<e.length;t++)e[t]=r[n],n++;return e})``;t(a,i,o)}})``;
				(()=>{"use strict";let{imageToCanvas:t,toImageData:e}=self["editImage.js"],n={loading:!0},a=$("#p_state"),i=$("#input_filename"),s=$("#radio_png"),d=$("#radio_jpg"),r=$("#input_jpg"),l=$("#anchor"),g=$("#div_canvasSize"),o=$("#canvas"),u=o.getContext("2d"),c=()=>{g.innerText="width: "+o.width+"\nheight: "+o.height},h=(()=>{let n=[null,null],i=async()=>{a.innerText="undo中",await sleep();let e=n[1];n[1]=n[0],n[0]=e,await t(e,o),a.innerText="undoしました"};return i.save=async t=>{n[1]=n[0],n[0]=await e(t)},i})``;defineProperty("constant.js",Object.freeze({state:n,p_state:a,input_filename:i,radio_png:s,radio_jpg:d,input_jpg:r,anchor:l,div_canvasSize:g,canvas:o,context:u,showCanvasSize:c,undo:h}))})``;
				(()=>{"use strict";let i=Object.prototype.toString,{state:t,p_state:e,input_filename:a,radio_png:n,radio_jpg:l,input_jpg:o,canvas:r,context:c,showCanvasSize:u,undo:d}=self["constant.js"],{imageToCanvas:s,imageToBlob:g,toImageElement:w,resize:v,enlarge:f,rotate:p,reverse:y,space:T,cut:x,insert:h}=self["editImage.js"];delete self["editImage.js"];let b=i=>{if(/\D/.test(i))throw Error("0以上の整数を入力してください");return Number(i)};{let _=$("#input_file"),k=$("#button_reset"),m,j;_.onchange=async()=>{if(!0!=t.loading&&void 0!=_.files[0]){if(t.loading=!0,e.innerText="画像を読み込んでいます",await sleep(),await drawImagefileToCanvas(m=_.files[0],r)!==void 0){t.loading=!1,e.innerText="画像を選択してください";return}j=m,u(),await d.save(r),t.loading=!1,e.innerText="画像を読み込みました"}},k.onclick=async()=>{if(!0!=t.loading){if(t.loading=!0,e.innerText="リセット中",await sleep(),void 0==j){e.innerText="画像ファイルが読み込まれていません",t.loading=!1;return}await drawImagefileToCanvas(j,r),u(),await d.save(r),t.loading=!1,e.innerText="リセットしました"}}}{let z=i=>{let t=a.value;t=t.replace(/\.\w*$/,""),a.value=t+i};n.oninput=()=>{o.style.visibility="hidden",z(".png")},l.oninput=()=>{o.style.visibility="visible",z(".jpg")}}$("#button_download").onclick=async()=>{if(!0==t.loading)return;t.loading=!0,e.innerText="ダウンロード準備中",await sleep(),URL.revokeObjectURL(anchor.href);let i=a.value,c=(()=>n.checked?"image/png":l.checked?"image/jpeg":void 0)``,u=(()=>{let i=Number(o.value);return i<0||i>1?(o.value=.85,o.value=.85,.85):(o.value=i,i)})``;anchor.download=i;try{anchor.href=await canvasToURL(r,c,u),e.innerText="ダウンロード可能"}catch(d){e.innerText=d}finally{t.loading=!1}};{let I=$(".input_radio"),D=$(".div_UI"),L=()=>{for(let i of D)i.style.display="none"};for(let U=0;U<I.length;U++)I[U].oninput=()=>{L(),D[U].style.display="inline"}}{let R=$("#input_resize_width"),S=$("#input_resize_height"),A=$("#input_resize_ratio");$("#button_resize").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="リサイズ中",await sleep();try{let i,a,n;if(""==A.value)a=Number(R.value),n=Number(S.value);else{let l=Number(A.value);a=Math.round(r.width*l),n=Math.round(r.height*l)}if(a<=0||n<=0)throw Error("自然数を入力してください");if(a>16384||n>16384)throw Error("最大サイズを超えています");await s(i=await v(r,a,n),r),u(),await d.save(r),e.innerText="リサイズしました"}catch(o){e.innerText=o}finally{t.loading=!1}}}}{let C=$("#input_enlarge"),E=i=>{e.innerText=`拡大中：${i}%`};$("#button_enlarge").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="拡大中",await sleep();try{let i=Number(C.value);if(/\D/.test(i)||i<2)throw Error("2以上の自然数を入力してください");let a=await f(r,i,void 0,void 0,E);await s(a,r),u(),await d.save(r),e.innerText="拡大しました"}catch(n){e.innerText=n}finally{t.loading=!1}}}}$("#button_reverse").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="左右反転中",await sleep();try{let i=await y(r);await s(i,r),await d.save(r),e.innerText="左右反転完了"}catch(a){e.innerText=a}finally{t.loading=!1}}};{let H=$("#input_space_left"),M=$("#input_space_right"),O=$("#input_space_top"),q=$("#input_space_bottom"),B=$("#input_space_background");$("#button_space").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="空白追加中",await sleep();try{let i=b(H.value),a=b(M.value),n=b(O.value),l=b(q.value),o=B.value,c=await T(r,i,a,n,l,o);await s(c,r),u(),await d.save(r),e.innerText="空白追加完了"}catch(g){e.innerText=g}finally{t.loading=!1}}}}{let F=$("#input_cut_left"),G=$("#input_cut_right"),J=$("#input_cut_top"),K=$("#input_cut_bottom");$("#button_cut").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="切り取り中",await sleep();try{let i=b(F.value),a=b(G.value),n=b(J.value),l=b(K.value),o=await x(r,i,a,n,l);await s(o,r),u(),await d.save(r),e.innerText="切り取り完了"}catch(c){e.innerText=c}finally{t.loading=!1}}}}{let N=$("#input_file_insert"),P=$("#input_insert_left"),Q=$("#input_insert_top");$("#button_insert").onclick=async()=>{if(!0!=t.loading&&void 0!=N.files[0]){t.loading=!0,e.innerText="画像を差し込み中",await sleep();try{let a=b(P.value),n=b(Q.value),l=await w(N.files[0]);if("[object HTMLImageElement]"!==i.call(l))throw Error("画像の差し込みに失敗しました");await h(r,l,a,n,r),await d.save(r),e.innerText="画像を差し込みました"}catch(o){e.innerText=o}finally{t.loading=!1}}}}$("#button_rotate").onclick=async()=>{if(!0!=t.loading){t.loading=!0,e.innerText="画像を回転中",await sleep();try{let i=await p(r);await s(i,r),u(),await d.save(r),e.innerText="回転しました"}catch(a){e.innerText=a}finally{t.loading=!1}}};{let V=$("#input_canvasSize");V.oninput=()=>{r.style.width=V.value}}{let W=$("#button_undo");W.onclick=async()=>{!0!=t.loading&&(t.loading=!0,await d(),u(),t.loading=!1)}}{let X=$("#button_canvasToImg"),Y=$("#button_imgToCanvas"),Z=$("#img");X.onclick=async()=>{if(!0==t.loading)return;t.loading=!0,e.innerText="img要素に描画中",await sleep();let i=await g(r),a=await (()=>new Promise(t=>{let e=new FileReader;e.readAsDataURL(i),e.onload=()=>{t(e.result)}}))``;Z.src=a,e.innerText="img要素に描画しました",t.loading=!1},Y.onclick=async()=>{if(!0==t.loading)return;if(""===Z.src){e.innerText="img要素がありません";return}t.loading=!0,e.innerText="img要素からcanvasに描画中",await sleep();let i=Z.src,a=i.atob(),n=new Blob([a]);await s(n,r),u(),await d.save(r),e.innerText="img要素からcanvasに描画しました",t.loading=!1}}})``;
				(async()=>{"use strict";let{state:t,p_state:a,canvas:e,context:i,showCanvasSize:$,undo:l}=self["constant.js"];i.fillStyle="#000000",i.fillRect(0,0,e.width,e.height),$(),await l.save(e),await l.save(e),a.innerText="画像を選択してください",t.loading=!1})``;
			</script>
		</div>
	</body>
</html>
